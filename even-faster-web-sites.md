# 《高性能网站建设进阶指南：Web开发者性能优化最佳实践》

## 第1章   理解Ajax性能

### 1.1 权衡

​		设计和构造计算机程序要经过成千上万次抉择，每一次都代表着一种权衡。在进行重大抉择时，每个选择都有其显著的优缺点，我哦们都期望收益最大化，损耗最小化。现实情况往往是：时间、质量和成本，三选二。这个项目三角形说明：即使在最理想的情况下，多快好省的事情也基本不存在，所以权衡无处不在。

 		计算机程序中，选择算法要权衡运行时间和内存，会为抢占市场而牺牲代码质量。这些权衡对增量式开发的最终效果影响巨大。每一次接触代码，我们都在权衡改善代码质量和避免产生BUG的可能性。关注程序性能时，我们必须反复斟酌所有权衡因素。

### 1.2 优化原则

​		优化的目的是希望降低程序的整体开销。虽然在程序中有许多因素可以优化，但通常人们会认为这个开销就是程序的执行时间。其实我们更应该把重点放在对程序整体开销影响最大的那部分。

​		循环嵌套越多，可优化的选择越少。如果循环的开销是O(nlogn)、O(n^2)或更糟，减少每次迭代的时间没有任何效果。唯一有效的选择是减少n，或更换算法，只有在n非常小时，调整每次迭代的开销才会有效果。必须正确地设计程序。如果程序不符合要求，即使它速度很快也没什么意义。无论如何，尽早在开发周期中测试程序是否有性能问题非常重要。在测试Web应用时，尽可能模仿真实的用户环境，使用低端机器和低速网络来测试，因为在开发人员的高配置环境中得出的测试结果很可能会掩盖性能问题。

### 1.3 Ajax

​		重构代码能明显降低其复杂性，所以对代码进行优化和其他修改更易产生效益。即便如吃，由于网页的大小和复杂性，要想把Web应用控制在低效线之下还是非常困难。网页通常内容多、代码量大且组成部分众多，在这之间的跳转会带来巨大的开销。因此对于连续页面之间差别很小的应用而言，使用Ajax技术能带来显著的改善。

### 1.4 浏览器

​		浏览器并非为应用平台而设计，因此编写Ajax应用程序极具挑战性。脚本语言和文档对象模型(DOM)原本只设计为支持由简单表单所组成的应用。令人惊讶的是，浏览器已具有足够的能力可能去实现复杂的应用，但不幸的是，它并未达到一切令人满意的地步，所以难度真的非常高。使用Ajax库能缓解这种情况。Ajax库能充分发挥JavaScript的表达能力把DOM提升到实用的水平，同时修复令应用无法在各个品牌浏览器中顺利运行的诸多障碍。

### 1.5 JavaScript

​		大部分JavaScript引擎的优化是为了快速抢占市场而不是性能，所以JavaScript一直很自然的被认为是瓶颈。但通常情况下，瓶颈不是JavaScript而是DOM，所以捣腾脚本收效甚微。尽量避免捣腾脚本，要正确并清晰地编写程序。捣腾往往越整越乱，它只会让程序更容易产生BUG。避免使用那些传说中能让程序更快的奇技淫巧，除非你能证明他们将给应用带来明显的质量提升。大多数情况下，它们只会降低代码质量，而不会有多大提升。不要纠结于特定浏览器的怪癖，浏览器仍在发展，最终会支持更好的编码实践。

​		如果必须要捣腾，首先要评估。我们对程序真正的开销的直觉往往是错的。只有通过正确的评估，才能有把握对性能产生积极的影响。

### 1.6 总结

​		一切都是权衡。当我们做性能优化时，不要浪费时间去尝试为那些不消耗大量时间的代码提速。评估优先，拒绝任何不能提供良好效益的优化。

​		浏览器通常在运行JavaScript上花费的时间很少，绝大部份时间消耗在DOM上。你可以要求浏览器制造商提供更好的性能评估工具。

​		为质量编程。简洁、易读且条理分明的代码更易于正确理解、维护和优化。避免耍小聪明，除非可以证明它们能大幅提升性能。



## 第2章    创建快速响应的Web应用

​		基于用户界面的需求，Web应用和传统桌面应用有一个共同的目标：尽可能快地响应用户的输入。当浏览器响应用户发起的加载网站的请求时，它需要处理大量与响应相关的工作：与用户请求的站点建立网络连接，解析HTML，请求相关资源等。详细地分析这个过程，我们可以找到方法优化页面，最大程度地提高渲染速度，但浏览器最终掌控着页面的加载和呈现。

